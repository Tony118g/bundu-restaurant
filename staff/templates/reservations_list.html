{% extends 'base.html' %}
{% block content %}

{% if messages %}
{% for message in messages %}
    <div id="msg" class="mx-auto alert alert-dismissible fade show alert-{{ message.tags }}" role="alert">
        <span>{{ message }}</span>
        <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">
            <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
        </button>
    </div>
{% endfor %}
{% endif %}

<div class="container fill-screen below-nav">
    <h2 class="text-capitalize">{{ status }} Reservations</h2>
    {% if reservation_list %}
    <table class="table tabel-striped table-hover table-bordered">
        <thead>
          <tr>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th scope="col">Number</th>
            {% if status == 'pending' %}
            <th scope="col">Staff Action</th>
            {% else %}
            <th scope="col">Email</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
            {% for reservation in reservation_list %}
            <tr>
                <td>{{reservation.date}}</td>
                <td>{{reservation.time}}</td>
                <td>{{reservation.no_of_people}}</td>
                {% if status == 'pending' %}
                <td>
                  <div class="row">
                    <div class="col-md-6">
                      <form action="{% url 'approve_reservation' reservation.id %}" method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{request.path}}"/>
                        <button class="btn btn-success" type="submit">Approve</button>
                      </form>
                    </div>
                    <div class="col-md-6">
                      <form action="{% url 'deny_reservation' reservation.id %}" method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{request.path}}"/>
                        <button class="btn btn-warning" type="submit">Deny</button>
                      </form>
                    </div>
                  </div>
                </td>
                {% else %}
                <td>{{reservation.email}}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
      </table>
    {% else %}
    <p>There are no {{ status }} reservations at the moment.</p>
    {% endif %}
</div>
{% endblock %}